module.exports = function Databattle() {
  var that = this;

  //
  // notifies onChange listeners
  //

  var notifyChange = (function() {
    var listeners = [];
    that.onChange = Array.prototype.push.bind(listeners);
    return function() {
      listeners.forEach(function(l) {l();});
    };
  })();

  that.getBoard = function() {
    return {
      cells: [
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],
        [{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}]
      ]
    };
  };

  function turn(i) {
    players[i].getMove(function() {
      notifyChange();
    });
  }
};
